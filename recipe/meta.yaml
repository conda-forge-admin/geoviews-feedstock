{% set version = "1.10.0" %}
{% set name = "geoviews" %}

package:
  name: {{ name }}-split
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: f38bdfb539ef0c7e478b1237dcc7a2fa796d814b1860c4f5b5190b541cd69036

build:
  number: 0
  #skip s390x as lack of nodejs and cartopy dependencies
  skip: True  # [py<38 or s390x]

outputs:
  - name: {{ name }}-core
    script: build_base.sh # [not win]
    script: build_base.bat # [win]
    build:
      entry_points:
        - geoviews = geoviews.__main__:main
    requirements:
      run_constrained:
        - {{ name }} {{ version }}
      host:
        - python
        - pip
        - setuptools
        - wheel
        - packaging
        - param 1.9.0
        - pyct 0.5.0
        - bokeh 3.1.1
        - nodejs 16.13.1
        - pyviz_comms 2.3.0
        - cartopy 0.21.1
      run:
        - python
        - panel >=1.0.3
        - bokeh >=3.1.1,<3.2
        - cartopy >=0.21.1
        - holoviews >=1.16.0
        - numpy
        - param >=1.9.2,<3.0
        - scipy
    test:
      requires:
        - pip
      commands:
        - pip check
      imports:
        - {{ name }}

  - name: {{ name }}
    requirements:
      host:
        - python
        - pip
        - setuptools
        - wheel
      run:
        - python
        - {{ pin_subpackage('geoviews-core', exact=True) }}
        - datashader
        - geopandas-base
        - netcdf4
        - pandas
        - pyct
        - xarray
        - shapely
        - scipy
        - pooch
    test:
      imports:
        - {{ name }}
      requires:
        - nbsmoke
        - pytest
        - pip
      commands:
        - pip check
        - geoviews examples --path=. --force
        # just run one notebook for now; increase in the future if notebooks can be run quickly with test/tiny data
        - pytest --nbsmoke-run -k ".ipynb" user_guide/Projections.ipynb
    about:
      home: https://geoviews.org
      license: BSD-3-Clause
      license_family: BSD
      license_file: LICENSE
      summary: GeoViews is a Python library that makes it easy to explore and visualize geographical, meteorological, and oceanographic datasets, such as those used in weather, climate, and remote sensing research.
      description: |
        GeoViews is built on the HoloViews library for building flexible visualizations of multidimensional data. 
        GeoViews adds a family of geographic plot types based on the Cartopy library, 
        plotted using either the Matplotlib or Bokeh packages.
      doc_url: https://geoviews.org
      dev_url: https://github.com/holoviz/geoviews

about:
  home: https://geoviews.org
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE
  summary: GeoViews is a Python library that makes it easy to explore and visualize geographical, meteorological, and oceanographic datasets, such as those used in weather, climate, and remote sensing research.
  description: |
    GeoViews is built on the HoloViews library for building flexible visualizations of multidimensional data. 
    GeoViews adds a family of geographic plot types based on the Cartopy library, 
    plotted using either the Matplotlib or Bokeh packages.
  doc_url: https://geoviews.org
  dev_url: https://github.com/holoviz/geoviews
extra:
  recipe-maintainers:
    - ocefpaf
    - philippjfr
    - maximlt
    - Hoxbro
